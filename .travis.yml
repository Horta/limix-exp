language: python
matrix:
  include:
  - os: linux
    sudo: false
    dist: trusty
    python: '2.7'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.5'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.6'
before_install:
- wget https://raw.githubusercontent.com/Horta/travis-miniconda/master/install.sh
  -O install.sh
- chmod +x install.sh
- travis_retry bash -x ./install.sh
install:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
before_script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py test
script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py sdist
- pip install dist/`ls dist | grep -i -E '\.(gz)$' | head -1`
- pushd /
- python -c "import limix_exp; limix_exp.test()"
- popd
branches:
  only:
  - master
notifications:
  email: false
deploy:
  provider: pypi
  user: dhorta
  password:
    secure: N0F0eMuZj3603130DOxnQdpmj+Xge0HKjW0ENLdj4dNJU3zi5IK0W+fvVNGbxNtjftv7M2jp+sHvn35Tl1lLwpGw0lJQDsenPYSQm10qr4/x6ZEhF8hOCl+K/hX1WL86JreTcO5y524T3dIiUntDP6rN5BSQWkTPzsgOEFHkC7nRLhMmdMPMdKVRIJd0jQUEYKxV25xzEYzCJKD0JYYBDYFrMd22RIRVxlUZgpjhsC3o8FuroCjM0qP8Zzj2UrRJNvYjaWKoNF/JnqSAiD6PQCHGJNwjdSV3Wd+tkEYHPh1ZrQMo2kXEyPPPtkfFu/7U8jInjIXlghH6CdOB0Rk4zWj8xtyC/4ajxXb8EaFTu7snpFsuQcTmQD1FTM+pKqCDyXIJdWHvx2+2ILCo75FITog1e+DqWK8cvh/Zeo9hq80t+dOHwXubP+Me+EDLlNA/g5Gd491WuqgIenhDXo04TQzy+6qk2VDO183+b4r2BGXtGn8Nut0fuUjLxns5mvYIaiwNn8FRjI22fZQbYeGvXak1VfxtQPFfRAaMifUdxj8HCtfCOR+J+LTPtw+2a1ybg14Y7gFXgP9eEtIVay4gjSZqkUjfr6BR+9fYjKLwZ3ihwEwg3h8OqSYzAVW2K67DhuNGwHXaOCdlQxrMN9OjAhqaZLjBq97KO6w20nxucrc=
  on:
    distributions: sdist bdist_wheel
    repo: Horta/limix-exp
